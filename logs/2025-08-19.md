↳ exit 0

### Command @ 2025-08-19 13:23:02 EDT
**# Probe status codes (200 expected)
for u in \
  https://raw.githubusercontent.com/ishist/context-vault/main/docs/customize.md \
  https://raw.githubusercontent.com/ishist/context-vault/main/docs/file-index.md
printf "%3s  %s\n" (curl -I -s -o /dev/null -w "%{http_code}" $u) $u
end**
↳ exit 0

### Command @ 2025-08-19 13:23:15 EDT
**# Fetch to a dated scratch and preview safely
set d (date +%F)
mkdir -p ~/Downloads/$d-context-vault && cd ~/Downloads/$d-context-vault
**
↳ exit 0

### Command @ 2025-08-19 13:23:38 EDT
**for u in \
  https://raw.githubusercontent.com/ishist/context-vault/main/docs/customize.md \
  https://raw.githubusercontent.com/ishist/context-vault/main/docs/file-index.md
echo "-> "(basename $u)
curl -fsS --retry 3 --retry-delay 2 -o (basename $u) $u
end**
↳ exit 0

### Command @ 2025-08-19 13:23:50 EDT
**for u in \
  https://raw.githubusercontent.com/ishist/context-vault/main/docs/customize.md \
  https://raw.githubusercontent.com/ishist/context-vault/main/docs/file-index.md
echo "-> "(basename $u)
curl -fsS --retry 3 --retry-delay 2 -o (basename $u) $u
end**
↳ exit 0
↳ exit 0

### Command @ 2025-08-19 13:37:02 EDT
**micro customize.md**
↳ exit 0

### Command @ 2025-08-19 13:43:22 EDT
**cd ..**
↳ exit 0

### Command @ 2025-08-19 13:43:28 EDT
**mkdir -p patches**
↳ exit 0

### Command @ 2025-08-19 13:43:57 EDT
**micro patches/customize-metadata-and-fix.patch**
↳ exit 0

### Command @ 2025-08-19 13:44:34 EDT
**cat patches/customize-metadata-and-fix.patch | cgpt -t2 diff**
↳ exit 0

### Command @ 2025-08-19 13:44:45 EDT
**# Preview the patch contents (trimmed for chat)
cat patches/customize-metadata-and-fix.patch | cgpt -t2 diff

# Dry run first
git apply --check patches/customize-metadata-and-fix.patch

# If no errors:
git apply patches/customize-metadata-and-fix.patch

# Inspect what changed
git diff -- docs/customize.md | cgpt -t2 diff**
↳ exit 0

### Command @ 2025-08-19 13:45:59 EDT
**# Save patch file
set p patches/customize-insert-sections.patch
mkdir -p (dirname $p)
begin
echo '--- a/docs/customize.md'
echo '+++ b/docs/customize.md'
echo '@@'
echo '-## Spec Maintenance'
echo '+## Spec Metadata'
echo '+- Last updated: 2025-08-19'
echo '+- Version: 0.1.0'
echo '+'
echo '+## Paths & Locations'
echo '+- Context Vault repo: `~/context-vault`'
echo '+- ctx* helpers live in: `~/bin` (on PATH) and/or `~/.config/fish/functions/` (document actual install)'
echo '+'
echo '+## cgpt Quick Reference'
echo '+- Clean + trim head/tail with language tag:'
echo '+  ```fish'
echo '+  some_command | cgpt -t2 md'
echo '+  ```'
echo '+  Use `-t` for head-only. Warn before pasting very large outputs.'
echo '+'
echo '+## Spec Maintenance'
end > $p

# Dry-run then apply
git apply --check $p
git apply $p

# Review & commit
git diff -- docs/customize.md | cgpt -t2 diff
git add docs/customize.md
git commit -m "docs(customize): add metadata, paths, and cgpt quick reference sections"**
↳ exit 0

### Command @ 2025-08-19 13:46:43 EDT
**set p patches/customize-insert-sections.patch
mkdir -p (dirname $p)
begin
echo '--- a/docs/customize.md'
echo '+++ b/docs/customize.md'
echo '@@'
echo '-## Spec Maintenance'
echo '+## Spec Metadata'
echo '+- Last updated: 2025-08-19'
echo '+- Version: 0.1.0'
echo '+'
echo '+## Paths & Locations'
echo '+- Context Vault repo: `~/context-vault`'
echo '+- ctx* helpers live in: `~/bin` (on PATH) and/or `~/.config/fish/functions/` (document actual install)'
echo '+'
echo '+## cgpt Quick Reference'
echo '+- Clean + trim head/tail with language tag:'
echo '+  ```fish'
echo '+  some_command | cgpt -t2 md'
echo '+  ```'
echo '+  Use `-t` for head-only. Warn before pasting very large outputs.'
echo '+'
echo '+## Spec Maintenance'
end > $p**
↳ exit 0

### Command @ 2025-08-19 13:46:49 EDT
**git apply --check $p
git apply $p**
↳ exit 0

### Command @ 2025-08-19 13:46:57 EDT
**git apply --check $p**
↳ exit 0

### Command @ 2025-08-19 13:49:11 EDT
**git diff -- docs/customize.md | cgpt -t2 diff**
↳ exit 0

### Command @ 2025-08-19 13:49:28 EDT
**git add docs/customize.md**
↳ exit 0

### Command @ 2025-08-19 13:49:34 EDT
**git commit -m "docs(customize): add metadata, paths, and cgpt quick reference sections"**
↳ exit 0

### Command @ 2025-08-19 14:16:51 EDT
**micro patches/customize-insert-sections.patch**
↳ exit 0

### Command @ 2025-08-19 14:17:30 EDT
**git apply --check patches/customize-insert-sections.patch**
↳ exit 0

### Command @ 2025-08-19 14:19:35 EDT
**cd ~/context-vault
set tmp (mktemp)

# Only insert if not already present
if not grep -q '^## Spec Metadata$' docs/customize.md
awk '
  BEGIN{done=0}
  /^## Spec Maintenance$/ && !done {
    print "## Spec Metadata";
    print "- Last updated: 2025-08-19";
    print "- Version: 0.1.0";
    print "";
    print "## Paths & Locations";
    print "- Context Vault repo: `~/context-vault`";
    print "- ctx* helpers live in: `~/bin` (on PATH) and/or `~/.config/fish/functions/` (document actual install)";
    print "";
    print "## cgpt Quick Reference";
    print "- Clean + trim head/tail with language tag:";
    print "  ```fish";
    print "  some_command | cgpt -t2 md";
    print "  ```";
    print "  Use `-t` for head-only. Warn before pasting very large outputs.";
    print "";
    print "## Spec Maintenance";
    done=1; next
  }
  {print}
  ' docs/customize.md > $tmp
mv $tmp docs/customize.md
else
echo "Metadata/paths/cgpt sections already present; skipping"
end

# Preview change safely
git diff -- docs/customize.md | cgpt -t2 diff
**
↳ exit 0

### Command @ 2025-08-19 14:19:51 EDT
**git add docs/customize.md
git commit -m "docs(customize): add metadata, paths, and cgpt quick reference sections"
**
↳ exit 0

### Command @ 2025-08-19 14:20:51 EDT
**awk '/^## Spec Metadata$|^## Paths & Locations$|^## cgpt Quick Reference$|^## Spec Maintenance$/{print NR": "$0}' docs/customize.md | cgpt -t2
**
↳ exit 0

### Command @ 2025-08-19 14:21:22 EDT
**set today (date -u +"%Y-%m-%d")
sed -i "s/^-\s\?Last updated: .*/- Last updated: $today/" docs/customize.md
git add docs/customize.md
git commit -m "docs(customize): bump Last updated date"**
↳ exit 0

### Command @ 2025-08-19 14:21:38 EDT
**ctxsum**

## Summary (fill me)
### Background
- 

### Decisions made
- 

### Current status
- 

### Open questions / next steps
- 

↳ exit 0

### Command @ 2025-08-19 14:23:39 EDT
**# 1) See exact status + CDN headers (rate limit, cache, POP)
for u in \
  https://raw.githubusercontent.com/ishist/context-vault/main/docs/customize.md \
  https://raw.githubusercontent.com/ishist/context-vault/main/docs/file-index.md
echo "== $u =="
curl -I -sS $u | cgpt -t2 http
end**
↳ exit 0

### Command @ 2025-08-19 14:23:56 EDT
**# 1) See exact status + CDN headers (rate limit, cache, POP)
for u in \
  https://raw.githubusercontent.com/ishist/context-vault/main/docs/customize.md \
  https://raw.githubusercontent.com/ishist/context-vault/main/docs/file-index.md
echo "== $u =="
curl -I -sS $u | cgpt -t2 http
end

# 2) Try alternate CDN paths (bypasses raw. host):
#    jsDelivr (GitHub -> CDN):
for p in docs/customize.md docs/file-index.md
set u https://cdn.jsdelivr.net/gh/ishist/context-vault@main/$p
echo "== $u =="; curl -I -sS $u | cgpt -t2 http
end

# 3) Force IPv4 vs IPv6 (helps isolate v6 path issues)
for flg in --ipv4 --ipv6
echo "== raw.githubusercontent.com $flg =="
curl $flg -I -sS https://raw.githubusercontent.com/ishist/context-vault/main/docs/customize.md | cgpt -t2 http
end

# 4) DNS sanity (see which POPs you resolve to)
for host in raw.githubusercontent.com raw.githack.com
echo "== $host =="; dig +short $host
end

# 5) Verbose TLS handshake (look for handshake resets/MITM)
echo "== TLS =="
curl -v -I https://raw.githubusercontent.com/ishist/context-vault/main/docs/customize.md ^/dev/null | cgpt -t2 http

# 6) User-Agent swap (some mirrors filter default curl UA)
curl -I -sS -H "User-Agent: Mozilla/5.0" https://raw.githack.com/ishist/context-vault/main/docs/customize.md | cgpt -t2 http
**
↳ exit 0

### Command @ 2025-08-19 14:27:05 EDT
**mkdir -p ~/Downloads/ctx && cd ~/Downloads/ctx**
↳ exit 0

### Command @ 2025-08-19 14:27:14 EDT
**fetch_ctx docs/customize.md customize.md
fetch_ctx docs/file-index.md file-index.md**
↳ exit 0

### Command @ 2025-08-19 14:28:35 EDT
**function fetch_ctx --description "Fetch GitHub raw with fallbacks (v4 first)"
set -l repo ishist/context-vault
set -l ref  main
set -l path $argv[1]
set -l out  $argv[2]

test -n "$path"; or begin
echo "usage: fetch_ctx <repo-path> [outfile]" >&2; return 2
end
test -n "$out"; or set out (basename $path)

set -l raw https://raw.githubusercontent.com/$repo/$ref/$path
set -l api https://api.github.com/repos/$repo/contents/$path?ref=$ref
set -l cdn https://cdn.jsdelivr.net/gh/$repo@$ref/$path

# try raw (IPv4), then API (raw accept), then jsDelivr; each with retries
for u in $raw $api $cdn
if string match -q "*api.github.com*" $u
set -l ok (curl --ipv4 -fsS --retry 4 --retry-delay 2 \
                -H "Accept: application/vnd.github.v3.raw" -o $out $u; echo $status)
else
set -l ok (curl --ipv4 -fsS --retry 4 --retry-delay 2 -o $out $u; echo $status)
end
test $ok -eq 0; and begin
echo "saved $path → $out (via $u)"; return 0
end
end

# last-resort: try IPv6 once for raw.githubusercontent
curl --ipv6 -fsS --retry 2 --retry-delay 2 -o $out $raw; and begin
echo "saved $path → $out (via IPv6 raw)"; return 0
end

echo "fetch_ctx: failed to fetch $path from all sources" >&2
return 1
end
**
↳ exit 0

### Command @ 2025-08-19 14:28:41 EDT
**fetch_ctx docs/customize.md customize.md
fetch_ctx docs/file-index.md file-index.md**
↳ exit 0

### Command @ 2025-08-19 14:30:37 EDT
**ctximport ~/Downloads/2025-08-19-profile-bootstrap-lock-context-dump.md**
↳ exit 0

### Command @ 2025-08-19 14:30:44 EDT
**ctxdone > ~/Downloads/(date)-context-vault-review.md**
